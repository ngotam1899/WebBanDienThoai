
const router = require("express-promise-router")()
const userController = require('../controllers/user')

const passport = require('passport')
require('../middlewares/passport')

router.route('/')
    .get(passport.authenticate('jwt', { session: false }), userController.getAllUser)
router.route('/find')
    .get(userController.findUserByPhone)
router.route('/api/auth/profile')
    .post(passport.authenticate('jwt', { session: false }), userController.returnUserByToken)
router.route('/authentication/activate/:tokenUser')
    .get(userController.activeAccount)
router.route('/activate-password/:tokenUser')
    .post(userController.activePassword)
router.route('/forgot-password')
    .post(userController.forgotPassword)
router.route('/signin')
    .post(passport.authenticate('local', { session: false }), userController.signIn)
router.route('/auth/google')
    .post(passport.authenticate('google-token', { session: false }), userController.authGoogle)
router.route('/auth/google-mobile')
    .post(userController.authGoogleMobile)
router.route('/auth/facebook')
    .post(passport.authenticate('facebook-token', { session: false }), userController.authFacebook)
router.route('/signup')
    .post(userController.signUp)
router.route('/logout')
    .get(userController.logOut)
router.route('/change-pwd')
    .post(passport.authenticate('jwt', { session: false }), userController.changePassword)
router.route('/session-user').get(userController.sessionUsers)
router.route('/online-user').get(userController.onlineUsers)
router.route('/:userID')
    .get(passport.authenticate('jwt', { session: false }), userController.getUser)
    .put(passport.authenticate('jwt', { session: false }), userController.updateUser)
    .delete(passport.authenticate('jwt', { session: false }), userController.deleteUser)

module.exports = router